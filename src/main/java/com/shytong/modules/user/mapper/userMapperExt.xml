<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- @author zhr 创建时间 2017-09-02 16:54:19-->
<mapper namespace="user_ext">
    <!--baseresult-->

    <resultMap id="BaseResultMap"   type="com.shytong.modules.user.model.UserDo">
        <result column="id" property="id" jdbcType="VARCHAR" />
        <result column="nick_name" property="nickName" jdbcType="VARCHAR" />
        <result column="account" property="account" jdbcType="VARCHAR" />
        <result column="status" property="status" jdbcType="TINYINT" />
        <result column="phone" property="phone" jdbcType="CHAR" />
        <result column="pwd" property="pwd" jdbcType="VARCHAR" />
        <result column="avatar" property="avatar" jdbcType="VARCHAR" />
        <result column="gmt_create" property="gmtCreate" jdbcType="TIMESTAMP" />
        <result column="creator_id" property="creatorId" jdbcType="VARCHAR" />
        <result column="gmt_modified" property="gmtModified" jdbcType="TIMESTAMP" />
        <result column="editor_id" property="editorId" jdbcType="VARCHAR" />
        <result column="is_deleted" property="isDeleted" jdbcType="TINYINT" />
    </resultMap>


    <select id="selectList" parameterType="java.util.Map" resultType="java.util.Map"  >
        SELECT                     
            id as id,            
            nick_name as nickName,            
            account as account,            
            status as status,            
            phone as phone,            
            pwd as pwd,            
            avatar as avatar,            
            gmt_create as gmtCreate,            
            creator_id as creatorId,            
            gmt_modified as gmtModified,            
            editor_id as editorId,            
            is_deleted as isDeleted
        from sy_user where 1=1  and is_deleted=0 
</select>
    <select id="findByAccount" parameterType="java.util.Map" resultType="com.shytong.modules.user.model.UserDo"  >
        SELECT
        id as id,
        nick_name as nickName,
        account as account,
        status as status,
        phone as phone,
        pwd as pwd,
        avatar as avatar,
        gmt_create as gmtCreate,
        creator_id as creatorId,
        gmt_modified as gmtModified,
        editor_id as editorId,
        is_deleted as isDeleted,
        country as country,
        province as province,
        city as city,
        sex as sex,
        union_id as unionId,
        open_id as openId
        from sy_user where 1=1  and is_deleted=0
        <if test="openId !=null ">
           and  open_id=#{openId}
        </if>
        <if test="unionId !=null ">
            and  union_id=#{unionId}
        </if>
        <if test="account !=null ">
            and  account=#{account}
        </if>



    </select>



    <select id="findByIdentifier" parameterType="java.util.Map" resultType="com.shytong.modules.user.model.UserDo"  >
        SELECT
       u. id as id,
       u. nick_name as nickName,
       u. account as account,
       u. status as status,
       u. phone as phone,
       u. pwd as pwd,
       u. avatar as avatar,
        u.gmt_create as gmtCreate,
        u.creator_id as creatorId,
        u.gmt_modified as gmtModified,
        u.editor_id as editorId,
        u.is_deleted as isDeleted
     FROM
	sy_user u
INNER JOIN sy_user_auth ua ON u.id = ua.user_id
where ua.sys_identifier=#{sysIdentifier}
  and ua.identifier=#{identifier}
   and ua.type= #{type}   and   u.is_deleted=0 and ua.is_deleted=0


    </select>



        </mapper>