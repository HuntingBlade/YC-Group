@#
layout("../common/base.html",{title:'亿创电力集团',nav:'index',header_css:""}){
#@
<div class="comm-warp-position">
    <div class="comm-wrapper-img">
        <div style="background: url(^{channelTopImg.sysValue!}) no-repeat center bottom;"></div>
    </div>
    <div class="comm-wrapper-content">
        <div class="comm-content-title">
            <div class="title">^{channelTitle.name}</div>
            <div>^{channelTitle.pageName}</div>
        </div>

        <div class="comm-content-title-nav">
            <ul id="nav_list">
                @#for(nav in navList){
                #@
                <li id="nav^{navLP.dataIndex}">
                    <!--                    href=^{nav.indexName}?channelId=^{nav.id}&pageNum=1-->
                    <a>^{nav.name}</a>
                </li>
                @#}#@
            </ul>
        </div>

        <div class="content-main">
            <div class="content-img-list">
                <ul class="banimg">
                    @#for(item in content.list){#@
                    <li>
                        <a>
                            <div class="case-img">
                                <img src=^{item.titleImg}>
                            </div>
                            <div class="case-info">
                                <h1>^{item.title}</h1>
                            </div>
                        </a>
                    </li>
                    @#}#@
                </ul>
                <!-- 分页 -->
                <div id="test1" style="text-align: center"></div>
            </div>
            @#for(article in qualificationArticleList) { #@
            <div class="content-main1"
                 style="background: url(^{article.titleImg!}) no-repeat bottom center; background-size: 100% auto;">
                <div class="content-main1-child">
                    <h2>
                        <i></i>
                        ^{article.title}
                        <i></i>
                    </h2>
                    ^{article.content}
                    @# }#@
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        var href = window.location.search;
        var pageNum = href.indexOf("pageNum=");
        var channelId = href.indexOf("channelId");
        var current_channelId = href.substring(channelId + 9);
        var current_page = href.substring(pageNum + 8);
        setWid();
        layui.use('laypage', function () {
            var laypage = layui.laypage;
            var totals = "^{content.total!}";
            //执行一个laypage实例
            laypage.render({
                theme: "#0d2e3d",
                elem: 'test1', //注意，这里的 test1 是 ID，不用加 # 号
                count: totals, //数据总数，从服务端得到
                curr: current_page,
                limit: 8,
                jump: function (obj, first) {
                    console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
                    console.log(obj.limit); //得到每页显示的条数
                    //首次不执行
                    if (!first) {
                        window.location.href = "/front/public/qualification?channelId=3&pageNum=" + obj.curr;
                    }
                }
            });
        });

        var navLen = $("#nav_list").children("li").length;
        if (navLen > 0) {
            $("#nav0 a").addClass("active");
        }
        console.log(window.location.host);
        $("#nav_list li").on("click", function () {
            var hurl = window.location.protocol + "//" + window.location.host + "/front/public/channelInfo";
            var data = {
                "channelId": 20,
                "pageNum": 1,
                "pageSize": 8
            };
            $.ajax({
                type: "POST",
                url: hurl,
                async: false,
                dataType: "json",
                contentType: 'application/json',
                data: JSON.stringify(data),
                success: function (res) {
                    console.log(res);
                }
            })
            ;

            var id = $(this).attr("id");
            for (var i = 0; i < navLen; i++) {
                var cid = $("#nav" + i).attr("id");
                if (id != cid) {
                    $("#nav" + i + " a").removeClass("active");
                }
                $("#" + id + " a").addClass("active");
                continue;
            }

        });
    });

    function setWid() {
        var wid = $(".banimg").width();
        var wid_li = wid / 4.1;
        var h_li = wid_li * 1.52;
        $(".banimg li").width(wid_li);
        $(".banimg li").height(h_li);
        var wid_img = wid_li * 0.96;
        var h_img = wid_img * 1.4;
        $(".banimg .case-img").height(h_img);
        console.log(wid);
    }

</script>
@# } #@