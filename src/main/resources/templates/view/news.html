@#
layout("../common/base.html",{title:'新闻中心-亿创电力集团',nav:'index',header_css:""}){
#@

<div class="comm-warp-position">
    <div class="comm-wrapper-img">
        <div style="background: url(^{channelTopImg.sysValue!}) no-repeat center bottom;"></div>
    </div>

    <div class="comm-wrapper-content">
        <div class="comm-content-title">
            <div class="title">^{channelTitle.name}</div>
            <div>^{channelTitle.pageName}</div>
        </div>

        <div class="comm-content-title-nav">
            <ul id="nav_list">
                @#for(nav in navList){ #@
                <li>
                    <a href="/front/public/news?channelId=^{nav.id}&pageNum=1" id="nav^{navLP.dataIndex}"
                       value="^{nav.id}">^{nav.name}</a>
                </li>
                @#}#@
            </ul>
        </div>

        <div class="content-main">
            <div class="news-list">
                @# for(news in newsContentList.list) { #@
                <div class="news-item">
                    <div class="news-one">
                        <a class="news-content" href="/front/public/detailed?articleId=^{news.id}">
                            <div class="news-wrapper">
                                <div class="news-body">
                                    <p class="date">
                                        <span class="md">^{news.postTime}<span>-</span></span><span class="year">^{news.postTime}</span>
                                    </p>
                                    <p class="title">^{news.title}</p>
                                    <div class="separator"></div>
                                    <p class="description">^{news.summary}</p>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
                @# } #@
            </div>
            <div id="test1" style="margin:0 auto;width: 85%;text-align: center"></div>
        </div>
    </div>
</div>


<script type="text/javascript">
    $(function () {
        var search = window.location.search;
        var channelId = search.substring(search.indexOf("channelId=") + "channelId=".length, search.indexOf("&"));
        var pageNum = search.substring(search.indexOf("pageNum=") + "pageNum=".length);
        var navLength = $("#nav_list").children("li").length;

        $("#nav0").addClass("active");  // 默认选中第一个
        for (var i = 0; i < navLength; i++) {
            var navId = $("#nav" + i).attr("value");
            if (navId == channelId) {
                $("#nav0").removeClass("active");
                $("#nav" + i).addClass("active");
                break;
            }
        }

        layui.use('laypage', function () {
            var laypage = layui.laypage;
            //执行一个laypage实例
            laypage.render({
                theme: "#0d2e3d",
                elem: 'test1', //注意，这里的 test1 是 ID，不用加 # 号
                count: "^{newsContentList.total}", //数据总数，从服务端得到
                curr: pageNum,
                limit: 6,
                jump: function (obj, first) {
                    //首次不执行
                    if (!first) {
                        $("#project-content-ul").empty();
                        setSonChannelContent(channelId, obj.curr, obj.limit);
                    }
                }
            });
        });
    });
</script>
@# } #@
